

<!doctype html>

<html lang="en">
    <head>
        <meta charset="utf-8">
        <script src="./web3.min.js"></script>
        <script src="./dist/harbour.js"> </script>
    </head>

    <body>
       <script defer>       
            var web3 = new Web3();
            web3.setProvider(new web3.providers.HttpProvider("http://localhost:8545"));
            var account = '0xf289100C664FD3cb75581b1b59e92974884aC766';

            var contractMap = new Map();
            contractMap.set('votingRight', 
                {
                    bytecode: '6060604052341561000f57600080fd5b604051610309380380610309833981016040528080518201919050505b60008090505b81518110156100b7576001600080848481518110151561004e57fe5b9060200190602002015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055505b8080600101915050610032565b5b50505b61023f806100ca6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806342b4632e14610054578063adfaa72e146100a5578063d936547e146100f6575b600080fd5b341561005f57600080fd5b61008b600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610147565b604051808215151515815260200191505060405180910390f35b34156100b057600080fd5b6100dc600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061019d565b604051808215151515815260200191505060405180910390f35b341561010157600080fd5b61012d600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506101f3565b604051808215151515815260200191505060405180910390f35b60008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1690505b919050565b60008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1690505b919050565b60006020528060005260406000206000915054906101000a900460ff16815600a165627a7a7230582036f0e31d90b2fc298f39fe2eab3ca27df22f723c2245c58cdc01f8e1c255d3420029',
                    arguments: ['0xf289100C664FD3cb75581b1b59e92974884aC766']
                }
            )

            contractMap.set('votingStrategy',
                {
                    bytecode: '6060604052341561000f57600080fd5b5b6101678061001f6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680637eae191114610054578063d4a8dd981461008f578063faeae2f1146100ca575b600080fd5b341561005f57600080fd5b6100756004808035906020019091905050610117565b604051808215151515815260200191505060405180910390f35b341561009a57600080fd5b6100b06004808035906020019091905050610123565b604051808215151515815260200191505060405180910390f35b34156100d557600080fd5b610101600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061012f565b6040518082815260200191505060405180910390f35b6000600190505b919050565b6000600190505b919050565b6000600190505b9190505600a165627a7a72305820954d6bcac9e5e41ba3306c2c2125dad921a981b06827e08f8712fab45bad20a80029',
                    arguments: ['0xf289100C664FD3cb75581b1b59e92974884aC766']
                }
            );

            var deployer = new Harbour.Deploy('0xf289100C664FD3cb75581b1b59e92974884aC766', 470000, 1000000000);

            deployer.deployContracts(contractMap).then(function(result) {
                var versionABI = [{"constant": false,"inputs": [{"name": "votingRights","type": "address"},{"name": "votingStrategy","type": "address"}],"name": "createCongress","outputs": [{"name": "","type": "uint256"}],"payable": false,"type": "function"},{"constant": false,"inputs": [{"name": "id","type": "uint256"}],"name": "getCongress","outputs": [{"name": "","type": "address"}],"payable": false,"type": "function"},{"constant": true,"inputs": [],"name": "lastId","outputs": [{"name": "","type": "uint256"}],"payable": false,"type": "function"},{"constant": false,"inputs": [{"name": "id","type": "uint256"}],"name": "destroyCongress","outputs": [],"payable": false,"type": "function"},{"anonymous": false,"inputs": [{"indexed": false,"name": "id","type": "uint256"},{"indexed": false,"name": "congress","type": "address"}],"name": "CongressCreated","type": "event"}];
                var versionAddress = '0x0027e796c509f272ffa24f2cbbdacf23a8a75282';
                var versionConnectionModel = new Harbour.ConnectionModel(web3, versionABI, versionAddress, account);
                var version = new Harbour.Version(versionConnectionModel);

                version.createCongress(result.votingRight, result.VotingStrategy).on('receipt', function(receipt){
                    console.log('DAO CREATED')
                    console.log(receipt);
                }).on('error', function(error) {
                    console.log('VERSION METHOD ERROR')
                    console.log(error);
                });
            }).error(function(error) {
                console.log('CONTRACT ERROR')
                console.log(error);
            });
        </script>
    </body>
</html>
