

<!doctype html>

<html lang="en">
    <head>
        <meta charset="utf-8">
        <script src="./web3.min.js"></script>
        <script src="./dist/harbour.js"> </script>
    </head>

    <body>
       <script defer> 
            // Init basic objects      
            var web3 = new Web3();
            web3.setProvider(new web3.providers.HttpProvider("http://localhost:8545"));
            var account = '0x59E64db1a709a5bDf71A3f1f580A487F58E5978D';

            var contractData = new Harbour.ContractData();
            var connectionModel = new Harbour.ConnectionModel(
                    web3,
                    account
            );

            // Init deploy object
            var deployer = new Harbour.Deploy(
                connectionModel,
                account,
                470000,
                1000000000
            );

            // create contract data map
            var contractMap = [];
            contractMap.push(contractData.getContractDataObjectByName('whitelistRights', [account]));
            contractMap.push(contractData.getContractDataObjectByName('votingStrategy', [account]));

            // deploy contracts
            deployer.deployContracts(contractMap).then(function(contractAddresses) {
                // connect to version contract
                var version = new Harbour.Version(
                    connectionModel,
                    contractData.getContractAbiByName('version'),
                    '0x6c3387b096f54d3bc58c8e9edc0b2d0d9730fbb1'
                );

                // create new DAO
                version.createCongress(
                    contractAddresses['whitelistRights'],
                    contractAddresses['votingStrategy']
                ).then(function(congressAddress) {
                    console.log(congressAddress);
                }).catch(function(error){
                    console.log(error);
                });
            });
        </script>
    </body>
</html>
