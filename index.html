

<!doctype html>

<html lang="en">
    <head>
        <meta charset="utf-8">
        <script src="./web3.min.js"></script>
        <script src="./dist/harbour.js"> </script>
    </head>

    <body>
       <script defer> 
            // Init basic objects      
            var web3 = new Web3();
            web3.setProvider(new web3.providers.HttpProvider("http://localhost:8545"));
            var account = '0x321c00b46f44ea274923232e815aeaca7336f0be';

            var contractData = new Harbour.ContractData();
            var connectionModel = new Harbour.ConnectionModel(
                    web3,
                    account
            );

            // Init deploy object
            var deployer = new Harbour.Deploy(
                connectionModel,
                account,
                470000,
                1000000000
            );

            // create contract data map
            var contractMap = [];
            contractMap.push(contractData.getContractDataObjectByName('votingRight', [account]));
            contractMap.push(contractData.getContractDataObjectByName('votingStrategy', [account]));

            // deploy contracts
            deployer.deployContracts(contractMap).then(function(contractAddresses) {
                // connect to version contract
                var version = new Harbour.Version(
                    connectionModel,
                    contractData.getContractAbiByName('version'),
                    '0xa312d5a2cb26dd2da28ee34c6e6793949201868b'
                );

                // create new DAO
                version.createCongress(
                    contractAddresses['votingRight'],
                    contractAddresses['votingStrategy']
                ).then(function(congressAddress) {
                    var payload = '';
                    version.getCongress(congressAddress).then(function(congress){
                        // congress.propose('').then(func...
                    });
                }).catch(function(error){
                    console.log(error);
                });
            });
        </script>
    </body>
</html>
