

<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <script src="./web3.min.js"></script>
        <script src="./dist/harbour.js"> </script>
    </head>
    <body>
       <script defer> 
            // Init basic objects      
            var web3 = new Web3();
            web3.setProvider(new web3.providers.HttpProvider("http://localhost:8545"));
            var account = '0x49D1c9d4f08D585D69b4Ed116c205fd82d75ef6c';

            var contractData = new Harbour.ContractData();
            var connectionModel = new Harbour.ConnectionModel(
                    web3,
                    account
            );

            // Init deploy object
            var deployer = new Harbour.Deploy(
                connectionModel,
                account,
                470000,
                1000000000
            );

            // create contract data map
            var contractMap = [];
            contractMap.push(contractData.getContractDataObjectByName('votingRight', [account]));
            contractMap.push(contractData.getContractDataObjectByName('votingStrategy', [account]));

            // deploy contracts
            deployer.deployContracts(contractMap).then(function(contractAddresses) {
                // connect to version contract
                var version = new Harbour.Version(
                    connectionModel,
                    contractData.getContractAbiByName('version'),
                    '0x2188000c0b1c21e138796358dacc434cae4363ba'
                );

                // create new DAO
                version.createCongress(
                    contractAddresses.votingRight,
                    contractAddresses.votingStrategy
                ).then(function(events) {
                    var payload = '';
                    //Get congress address
                    version.getCongress(events.CongressCreated.id).then(function(congress){
                        console.log('congress address', congress)
                    });
                }).catch(function(error){
                    console.log(error);
                });
            });
        </script>
    </body>
</html>
